(()=>{"use strict";function e(e){this.message=e}e.prototype=new Error,e.prototype.name="InvalidCharacterError";var t="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var n=String(t).replace(/=+$/,"");if(n.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,r,a=0,i=0,l="";r=n.charAt(i++);~r&&(o=a%4?64*o+r:r,a++%4)?l+=String.fromCharCode(255&o>>(-2*a&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return l};function n(e){var n=e.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:n+="==";break;case 3:n+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(t(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(n)}catch(e){return t(n)}}function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidTokenError";(()=>{try{const e=function(e,t){if("string"!=typeof e)throw new o("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(n(e.split(".")[r]))}catch(e){throw new o("Invalid token specified: "+e.message)}}(localStorage.getItem("token"));console.log(e);const t=+Date.now().toString().slice(0,10);if(console.log("exp: "+e.exp,"now: "+t),e.exp<t)throw localStorage.removeItem("token"),console.log("token expired"),new Error("token expired");console.log("token valid"),e.admin&&document.querySelector("#emp-link").classList.remove("d-none")}catch(e){console.log(e),location.replace("login.html")}})(),(async()=>{const e=await fetch("http://localhost:7778/api/blog");(await e.json()).forEach((e=>{document.querySelector("#output").insertAdjacentHTML("beforeend",`\n    <a href="edit.html?id=${e._id}" class="post">\n        <div class="img-container">\n          <img src="${e.imgURL}" alt="${e.title}">\n        </div>\n        <div class="right">\n          <div class="top">\n            <div>\n              <h3>${e.title}</h3>\n              <small>${e.author.firstName} ${e.author.lastName}</small>\n            </div>\n            <ul id="tags${e._id}" class="tags">\n            </ul>\n          </div>\n          <div class="body">\n            <p class="snippet">${e.body.slice(0,50)}...</p>\n            <p class="likes">likes: <span>${e.likes}</span></p>\n          </div>\n        </div> \n      </a>\n    `);const t=document.querySelector("#tags"+e._id);e.tags.forEach((e=>{const n=document.createElement("li");n.className="tag",n.innerText=e,t.append(n)}))}))})(),document.querySelector("#logoutBtn").addEventListener("click",(()=>{localStorage.removeItem("token"),location.replace("login.html")}))})();